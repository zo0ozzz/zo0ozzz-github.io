<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>zo0ozzz</title>
    <link rel="stylesheet" href="css/css.css">
    <script src="javascript/script.js"></script>
  </head>
  <body>
    <!-- 바깥쪽 컨테이너 -->
    <div class = "Container1">
      <div></div>
      <!-- 안쪽 컨테이너 -->
      <div class = "Container2">
        <!-- 블로그 이름 -->
        <div class="BlogNameSpace">
          <p id = "BlogName"><a href = "index.html" style = "text-decoration: none">zo0ozzz</a></p>
          </div>
        <div></div>
        <!-- 날짜 -->
        <div class="DateSpace">
          <p></p>
          </div>
        <div></div>
        <div></div>
        <!-- 제목 -->
        <div class="SubjectSpace">
          <h1 id="Subject">모든 글 목록</h1>
          </div>
        <div></div>
        <div></div>
        <!-- 본문 -->
        <div class="ContentSpace">
          
          <p id = "List">
          <script>
            Main_List_AllPosts();
            </script>
            </p>

            <br>
            <br>

            <p class = "Pagination" style="text-align: center">
              <!-- <input id = "LeftDoubleArrow" type = "button" value = "<<" onclick = ""> -->
              <input id = "LeftArrow" type = "button" value = "<" onclick = "">
             
              <script>

                  const Posts = document.querySelectorAll('.ContentSpace #Posts');
                  // -> (날짜 + 목록) 리스트를 선택. 즉, 앞서 사용된 Main_List_AllPosts();로 출력된 <p id = "Posts">에 속한 요소들을 선택해 노드리스트로 만든다.
                  const PostsPerPage = 10;
                  // -> 한 페이지에 들어갈 콘텐츠의 수 지정. 필요한 총 페이지 수를 구하기 위함.
                  const PostsCount = Posts.length;
                  // -> 전체 콘텐츠의 수. 필요한 총 페이지 수를 구하기 위함.
                  const PageCount = Math.ceil(PostsCount/PostsPerPage);
                  // -> 전체 콘텐츠 / 한 페이지 들어갈 콘텐츠 수, 연산으로 필요한 총 페이지 수를 구한다.

                  for(i = 1; i <= PageCount; i++){
                    document.write('<button>' + i + '</button>');
                  }
                  // -> 버튼 형식으로 페이지들을 만든다.
                
                </script>
              <input id = "RightArrow" type = "button" value = ">" onclick = "">
              <!-- <input id = "RightDoubleArrow" type = "button" value = ">>" onclick = ""> -->
              
              <script>

                  const PageBtn = document.querySelectorAll('button');
                  // -> 앞서 만든 페이지 버튼들을 선택한다. 클릭 시 실행될 기능을 설정해주기 위함.

                  PageBtn.forEach(function(item, index){
                  // -> 클릭된 페이지의 인덱스를 활용하여 감추고 보여줄 자료의 범위를 지정해줄 것. index와 연계해 사용할 수 있는 반복문 forEach를 썼다.
                    item.addEventListener('click', function(event){
                    // -> 이벤트리스너로 페이지 버튼이 클릭되면 실행할 기능을 설정.
                      ClickPageBtn(index)
                      // -> 클릭되면 그 이벤트가 발생한 요소에 대해 이 함수를 실행시켜줄 거다. 만들자.
                    })
                  })

                  function ClickPageBtn(index){
                  for(let p of Posts){
                        p.style.display = 'none';
                      }
                      // -> 버튼 클릭 시 일단 모든 페이지를 숨겨준다.
                      /*
                      btn 1[0] -> Posts 1 2 3[0 1 2] -> Posts.Slice(0, 3)
                      btn 2[1] -> Posts 4 5 6[3 4 5] -> Posts.Slice(3, 6)
                      */
                      // -> 보여줄 자료들을 지정할 때 slice(); 메서드를 사용할 것.
                      let begin = index*PostsPerPage;
                      let end = begin + PostsPerPage;
                      // -> 클릭된 페이지 버튼의 인덱스에 연계해 슬라이스 안에 들어갈 숫자들을 변수에 담는다.
                      let PostsArray = [...Posts];
                      // -> 쿼리셀렉터로 선택한 Posts는 NodeList이기 때문에 그대로는 .slice();로 처리할 수 없다. 전개연산자를 이용해 형태를 진짜 배열로 바꿔준다. 
                      let SlicedPostsArray = PostsArray.slice(begin, end);
                      for(let spa of SlicedPostsArray){
                        spa.style.display = '';
                        spa.style.display = 'inline'
                        // -> 보여져야 할 배열의 요소에 대해 반복문으로 display 속성을 바꿔준다.
                      }
                      for(let pb of PageBtn){
                        pb.classList.remove('active');
                      }
                        PageBtn[index].classList.add('active');
                        // -> 현재 클릭된 페이지 버튼을 표시하기 위해 클릭되면 버튼 요소에 active 클래스를 추가해준다. css에서 active 클래스의 디자인을 바꿔 구분.
                    }

                    ClickPageBtn(0);
                    // -> 목록으로 들어와서 첫 화면에 페이지버튼 1을 클릭한 화면을 보여준다. 디폴트값.

                    // 이제 페이지버튼이 몇 개까지 표시될 건지도 지정해준다.
                    const PagePerMetaPage = 3;
                    // -> 화면에 표시될 페이지 버튼의 수.
                    const MetaPageCount = Math.ceil(PageCount/PagePerMetaPage);
                    // -> 페이지 버튼은 총 몇 개의 그룹으로 나뉠 것인지 계산.
                    let DefaultMetaPage = 0;
                    // -> '>' 버튼이 클릭될 때마다 그룹 인덱스를 하나씩 올려줄 거라 디폴트값은 우선 0으로 줬다.
                    const LeftArrow = document.querySelector('#LeftArrow');
                    const RightArrow = document.querySelector('#RightArrow');
                    // -> 페이지 버튼 그룹 이동을 위한 '<', '>' 버튼을 선택. 이 버튼에 이전/다음 그룹으로 이동시킬 기능을 부여할 거다.
                    // const LeftDoubleArrow = document.querySelector('#LeftDoubleArrow');
                    // const RightDoubleArrow = document.querySelector('#RightDoubleArrow');

                    /*
                    MetaPage 1[0] -> Btn 1 2 3 4 5[0 1 2 3 4] -> slice(0, 5)
                    MetaPage 2[1] -> Btn 6 7 8 9 10[5 6 7 8 9] -> slice(5, 10)
                    */

                    function ShowAndHidePageBtn(DefaultMetaPage){
                      // -> 페이지 버튼을 조정하는 함수. 이전에 특정 자료만 숨기고 보여주는 함수와 기본적으로 비슷한 메커니즘을 갖는다.
                      for(let pb of PageBtn){
                        pb.style.display = 'none';
                      }

                      const begin = DefaultMetaPage*PagePerMetaPage;
                      const end = begin + PagePerMetaPage;
                      const PageBtnArray = [...PageBtn];
                      const SlicedPageBtn = PageBtnArray.slice(begin, end);

                      for(let spb of SlicedPageBtn){
                        spb.style.display = '';
                      }

                      if(DefaultMetaPage == 0){
                        LeftArrow.style.display = 'none';
                      }
                      else{
                        LeftArrow.style.display = '';
                      }
                      // -> 페이지 버튼의 첫 번째 그룹을 표시할 땐 왼쪽 화살표 버튼을 숨긴다.

                      // if(DefaultMetaPage == 0){
                      //   LeftDoubleArrow.style.display = 'none';
                      // }
                      // else{
                      //   LeftDoubleArrow.style.display = '';
                      // }

                      if(DefaultMetaPage == MetaPageCount - 1){
                        RightArrow.style.display = 'none';
                      }
                      else{
                        RightArrow.style.display = '';
                      } 
                      // -> 페이지 버튼의 마지막 그룹을 표시할 땐 오른쪽 화살표 버튼을 숨긴다.

                      // if(DefaultMetaPage == MetaPageCount - 1){
                      //   RightDoubleArrow.style.display = 'none';
                      // }
                      // else{
                      //   RightDoubleArrow.style.display = '';
                      // } 
                    }

                    ShowAndHidePageBtn(0);

                    LeftArrow.addEventListener('click', function(event){
                      --DefaultMetaPage                      
                      // -> 이 기능이 실행될 때마다 이 값이 1씩 떨어진다.
                      ShowAndHidePageBtn(DefaultMetaPage);
                      ClickPageBtn(DefaultMetaPage*PagePerMetaPage);
                    })
                    // -> 왼쪽 화살표 버튼을 클릭하면 실행시킬 함수를 설정. 감소한 값이 매개 변수로 사용된다.

                    // LeftDoubleArrow.addEventListener('click', function(event){               
                    //   let DefaultMetaPage = 0;
                    //   ShowAndHidePageBtn(0);
                    //   ClickPageBtn(0);
                    // })

                    RightArrow.addEventListener('click', function(event){
                      ++DefaultMetaPage
                      // -> 이 기능이 실행될 때마다 이 값이 1씩 증가한다. 증가한 값이 매개 변수로 사용된다.
                      ShowAndHidePageBtn(DefaultMetaPage);
                      ClickPageBtn(DefaultMetaPage*PagePerMetaPage);
                    })
                    // -> 오른쪽 화살표 버튼을 클릭하면 실행시킬 함수를 설정.

                    // RightDoubleArrow.addEventListener('click', function(event){
                    //   let DefaultMetaPage = MetaPageCount - 1;
                    //   ShowAndHidePageBtn(MetaPageCount - 1);
                    //   ClickPageBtn((MetaPageCount - 1)*PagePerMetaPage);
                    // })


               </script>
             
            </p>

          </div>
          <!-- 사이드바 -->
        <div class="SidebarSpace">
          <!-- 카테고리별 -->
          <span id="Sidebar1">카테고리별 분류<br><br></span>
          <script>
            Sidebar_List_AllPosts();
            Sidebar_List_Category();
          </script>

          <br>
          <br>
          <br>
          <!-- 월별 -->
          <span id="Sidebar2">월별 분류<br><br></span>
          <script>
            Sidebar_List_YearMonth();
          </script>
          </div>


        </div>
      <div></div>
      <div class="GridBottom"></div>

      </div>
  </body>

</html>
